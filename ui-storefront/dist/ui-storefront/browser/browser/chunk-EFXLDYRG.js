import{a as $,b as K}from"./chunk-BQPSHSE7.js";import{j as P,k as _}from"./chunk-2QMXN6IA.js";import{a as O,d as F,g as w,h as k}from"./chunk-DVOWGLWX.js";import"./chunk-6XXA7HXI.js";import{c as U,e as f,g as A,h as B,k as j,m as z,n as R,s as T,u as G}from"./chunk-DXG57NUO.js";import{c as I}from"./chunk-6BHGGHL4.js";import{$a as i,$c as L,Aa as u,Sa as g,Vc as D,Xc as E,Yc as y,Zc as N,_c as V,a as p,ab as e,ad as q,bb as s,cd as H,dc as S,dd as J,ea as b,gb as h,gc as v,qb as t,rb as l,sb as C,yb as M,za as o}from"./chunk-7YDK76WO.js";var ce=(()=>{class c{constructor(r,n,a,m){this.fb=r,this.router=n,this.snackBar=a,this.http=m,this.userData={},this.loading=!1}ngOnInit(){this.loadUserData(),this.initializeForm()}loadUserData(){let r=localStorage.getItem("user"),n=localStorage.getItem("username"),a=localStorage.getItem("userId"),m=localStorage.getItem("userEmail"),x=localStorage.getItem("userRole");if(r)try{this.userData=JSON.parse(r)}catch{this.userData={username:n,userId:a,email:m,role:x}}else this.userData={username:n,userId:a,email:m,role:x};a&&this.http.get(`http://localhost:8004/users/${a}`).subscribe({next:d=>{this.userData=p(p({},this.userData),d),this.profileForm.patchValue(d)},error:d=>{console.error("Failed to load user data:",d)}})}initializeForm(){this.profileForm=this.fb.group({username:[this.userData.username||"",f.required],email:[this.userData.email||"",[f.required,f.email]],firstName:[this.userData.firstName||""],lastName:[this.userData.lastName||""],phone:[this.userData.phone||""]})}updateProfile(){if(this.profileForm.invalid)return;this.loading=!0;let r=this.userData.userId||this.userData.id;this.http.put(`http://localhost:8004/users/${r}`,this.profileForm.value).subscribe({next:n=>{this.loading=!1,this.userData=p(p({},this.userData),n),localStorage.setItem("user",JSON.stringify(this.userData)),localStorage.setItem("username",n.username),this.snackBar.open("Profile updated successfully!","Close",{duration:3e3})},error:n=>{this.loading=!1,this.snackBar.open("Failed to update profile. Please try again.","Close",{duration:3e3}),console.error("Update error:",n)}})}cancel(){this.router.navigate(["/"])}getInitials(){let r=this.userData.username||this.userData.email||"U",n=r.split(" ");return n.length>1?(n[0][0]+n[1][0]).toUpperCase():r.substring(0,2).toUpperCase()}static{this.\u0275fac=function(n){return new(n||c)(u(T),u(I),u(P),u(v))}}static{this.\u0275cmp=b({type:c,selectors:[["app-profile"]],standalone:!0,features:[M],decls:78,vars:10,consts:[[1,"profile-container"],[1,"profile-header"],[1,"avatar-large"],[1,"profile-content"],[1,"profile-card"],[3,"ngSubmit","formGroup"],["appearance","outline",1,"full-width"],["matInput","","formControlName","username"],["matSuffix",""],["matInput","","type","email","formControlName","email"],["matInput","","formControlName","firstName"],["matInput","","formControlName","lastName"],["matInput","","formControlName","phone"],[1,"button-group"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["mat-button","","type","button",3,"click"],[1,"detail-row"],[1,"label"],[1,"value"]],template:function(n,a){n&1&&(i(0,"div",0)(1,"div",1)(2,"div",2),t(3),e(),i(4,"div")(5,"h1"),t(6),e(),i(7,"p"),t(8),e()()(),i(9,"div",3)(10,"mat-card",4)(11,"mat-card-header")(12,"mat-card-title")(13,"mat-icon"),t(14,"person"),e(),t(15," Personal Information "),e()(),i(16,"mat-card-content")(17,"form",5),h("ngSubmit",function(){return a.updateProfile()}),i(18,"mat-form-field",6)(19,"mat-label"),t(20,"Username"),e(),s(21,"input",7),i(22,"mat-icon",8),t(23,"person"),e()(),i(24,"mat-form-field",6)(25,"mat-label"),t(26,"Email"),e(),s(27,"input",9),i(28,"mat-icon",8),t(29,"email"),e()(),i(30,"mat-form-field",6)(31,"mat-label"),t(32,"First Name"),e(),s(33,"input",10),e(),i(34,"mat-form-field",6)(35,"mat-label"),t(36,"Last Name"),e(),s(37,"input",11),e(),i(38,"mat-form-field",6)(39,"mat-label"),t(40,"Phone"),e(),s(41,"input",12),i(42,"mat-icon",8),t(43,"phone"),e()(),i(44,"div",13)(45,"button",14)(46,"mat-icon"),t(47,"save"),e(),t(48),e(),i(49,"button",15),h("click",function(){return a.cancel()}),t(50,"Cancel"),e()()()()(),i(51,"mat-card",4)(52,"mat-card-header")(53,"mat-card-title")(54,"mat-icon"),t(55,"info"),e(),t(56," Account Details "),e()(),i(57,"mat-card-content")(58,"div",16)(59,"span",17),t(60,"User ID:"),e(),i(61,"span",18),t(62),e()(),i(63,"div",16)(64,"span",17),t(65,"Role:"),e(),i(66,"span",18),t(67),e()(),i(68,"div",16)(69,"span",17),t(70,"Account Created:"),e(),i(71,"span",18),t(72),e()(),i(73,"div",16)(74,"span",17),t(75,"Last Updated:"),e(),i(76,"span",18),t(77),e()()()()()()),n&2&&(o(3),l(a.getInitials()),o(3),l(a.userData.username||"User"),o(2),l(a.userData.email||""),o(9),g("formGroup",a.profileForm),o(28),g("disabled",!a.profileForm.valid||a.loading),o(3),C(" ",a.loading?"Saving...":"Save Changes"," "),o(14),l(a.userData.userId||"N/A"),o(5),l(a.userData.role||"CUSTOMER"),o(5),l(a.userData.createdAt||"N/A"),o(5),l(a.userData.updatedAt||"N/A"))},dependencies:[S,J,V,q,H,L,E,D,N,y,k,w,O,F,K,$,G,j,U,A,B,z,R,_],styles:[".profile-container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:24px}.profile-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:24px;margin-bottom:32px;padding:24px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border-radius:12px;box-shadow:0 4px 12px #00000026}.avatar-large[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:50%;background:#fff3;display:flex;align-items:center;justify-content:center;font-size:32px;font-weight:700;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:3px solid rgba(255,255,255,.3)}.profile-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:28px}.profile-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:4px 0 0;opacity:.9}.profile-content[_ngcontent-%COMP%]{display:grid;grid-template-columns:2fr 1fr;gap:24px}.profile-card[_ngcontent-%COMP%]{margin-bottom:24px}mat-card-header[_ngcontent-%COMP%]{margin-bottom:16px}mat-card-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:20px}.full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:16px}.button-group[_ngcontent-%COMP%]{display:flex;gap:12px;margin-top:24px}.detail-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:12px 0;border-bottom:1px solid #f0f0f0}.detail-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.label[_ngcontent-%COMP%]{font-weight:600;color:#666}.value[_ngcontent-%COMP%]{color:#333}@media (max-width: 768px){.profile-content[_ngcontent-%COMP%]{grid-template-columns:1fr}.profile-header[_ngcontent-%COMP%]{flex-direction:column;text-align:center}}"]})}}return c})();export{ce as ProfileComponent};
